<div class="topic-container">
  
  <div *ngIf="isLoading" class="loading-message">
    <h3>Loading Levels...</h3>
  </div>

  <div class="level-sidebar" *ngIf="!isLoading">
    <h3>{{ topicId | titlecase }}</h3> 
    
    <button *ngFor="let level of currentLevels" 
            class="level-item" 
            [class.active]="selectedLevel?.id === level.id"
            [class.locked-item]="level.levelNumber > unlockedLevel" 
            (click)="selectLevel(level)">
      
      <div class="level-info">
        <span class="status-icon">
          <span *ngIf="level.levelNumber < unlockedLevel" style="color: #00ff88;">Done</span>
          <span *ngIf="level.levelNumber === unlockedLevel" style="color: #00f2ff;">Current</span>
          <span *ngIf="level.levelNumber > unlockedLevel" style="color: #4a5568;">Locked</span>
        </span>
        <span class="level-title">Level {{ level.levelNumber }}: {{ level.title }}</span>
      </div>
    </button>
  </div>

  <div class="workspace" *ngIf="!isLoading && selectedLevel">
    <div>
      <h2>{{ selectedLevel.title }}</h2>
      
      <p class="instruction">{{ selectedLevel.question }}</p>

      <app-main-visualizer (codeChange)="handleCodeFromChild($event)"></app-main-visualizer>
      
      <div class="actions">
        <app-smart-hint [currentCode]="userAnswer" [currentTopic]="topicId"></app-smart-hint>

        <button class="btn-submit" 
                (click)="submitAnswer()" 
                [disabled]="isChecking">
          <span *ngIf="!isChecking">Submit Code</span>
          <span *ngIf="isChecking">Analyzing...</span>
        </button>
      </div>

      <div *ngIf="feedbackMessage" 
           class="feedback-box" 
           [ngClass]="{'success': showSuccess, 'error': !showSuccess}">
        <span class="icon"></span> 
        <span>{{ feedbackMessage }}</span>
      </div>

    </div>
  </div>
</div>